# Назначение инструмента

Создание через API Континент 4 правил фильтрации (FW) и правил трансляции (NAT), включая связанные с ними объекты, по заданному в формате `*.xls` шаблону.

# Основные функции инструмента

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Создание или повторное использование необходимых согласно шаблону объектов.
3. Создание правил фильтрации (FW) и правил трансляции (NAT) в порядке их следования в шаблоне.
4. Назначение им созданных ранее объектов.
5. Вывод на экран справки по использованию инструмента.

> Инструмент можно использовать для миграции с решений других вендоров (в особенности - Palo Alto Networks) через промежуточный формат данных в предписанном шаблоном объеме.
> Допускается редактировать шаблон вручную, но только с сохранением оригинальной структуры таблиц и листов.

# Приложения

В качестве входных данных инструмент использует файл `*.xls` со следующими листами:

- `FW` - список правил фильтрации;
- `NAT` - список правил трансляции.

Лист `FW` содержит следующие поля:

- `Name` - название правила фильтрации;
- `Source` - список объектов, используемых в качестве отправителей сетевого трафика;
- `Destination` - список объектов, используемых в качестве получателей сетевого трафика;
- `Serivce` - список портовых сервисов, используемых в качестве дополнительного критерия отбора;
- `Description` - краткое текстовое описание правила фильтрации.

Для полей `Source` и `Destination` допустимо задание следующих значений:

- `any` - соответствует любому возможному отправителю сетевого трафика;
- `AAA.BBB.CCC.DDD` - приводит к созданию и/или использованию сетевого объекта типа "Хост";
- `AAA.BBB.CCC.DDD\MM` - приводит к созданию и/или использованию сетевого объекта типа "Подсеть";
- `AAA.BBB.CCC.DDD-AAA.BBB.CCC.DDD` - приводит к созданию и/или использованию сетевого объекта типа "Диапазон".

Для поля `Service` допустимо задание следующих значений:
- `any` - соответствует любому возможному портовому сервису;
- `tcp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом TCP и заданным номером порта получателя `PPPPP`;
- `udp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом UDP и заданным номером порта получателя `PPPPP`;
- `{proto}/PPPPP-PPPPP` - приводит к созданию и/или использованию сервиса с заданным диапазоном номеров портов получателя.

Лист `NAT` содержит следующие поля:

- `Name` - название правила трансляции;
- `Original Source` - список объектов, используемых в качестве исходных отправителей сетевого трафика;
- `Destination` - список объектов, используемых в качестве исходных получателей сетевого трафика;
- `Original Service` - исходный портовый сервис (только один);
- `Translation Type` - тип трансляции (адрес отправителя / адрес получателя);
- `Translated Interface` - сетевой интерфейс, в адрес которого осуществляется трансляция;
- `Translated Address` - адрес трансляции;
- `Translated Service` - транслированный портовый сервис (только один);
- `Bi-directional` - признак использования двусторонней трансляции (приводит к созданию дополнительного зеркального правила трансляции с типом "Отобразить").

Для полей `Original Source` и `Original Destination` допустимо задание следующих значений:

- `any` - соответствует любому возможному отправителю сетевого трафика;
- `AAA.BBB.CCC.DDD` - приводит к созданию и/или использованию сетевого объекта типа "Хост";
- `AAA.BBB.CCC.DDD\MM` - приводит к созданию и/или использованию сетевого объекта типа "Подсеть";
- `AAA.BBB.CCC.DDD-AAA.BBB.CCC.DDD` - приводит к созданию и/или использованию сетевого объекта типа "Диапазон".

Для поля `Original Service` допустимо задание следующих значений:

- `tcp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом TCP и заданным номером порта получателя `PPPPP`;
- `udp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом UDP и заданным номером порта получателя `PPPPP`.

Для поля `Translation Type` допустимо задание следующих значений:

- `snat/none` - соответствует правилу трансляции с типом "Не транслировать";
- `snat/dynamic-ip-and-port` - соответствует правилу трансляции с типом "Скрыть" или "Отправителя";
- `snat/dynamic-ip` - игнорируется при любых значениях других полей;
- `snat/static-ip` - соответствует правилу трансляции с типом "Отобразить";
- `dnat/none` - соответствует правилу трансляции с типом "Не транслировать";
- `dnat/dynamic-ip` - игнорируется при любых значениях других полей;
- `dnat/static-ip` - соответствует правилу трансляции с типом "Получателя".

Для поля `Translated Interface` допустимо задание следующих значений:

- `none` - значение не задано, игнорируется;
- `{iface_name}` - обозначение сетевого интерфейса, игнорируется при любых значениях других полей;
- `n/a` - значение не валидно для данного типа трансляции, игнорируется.

Для поля `Translated Address` допустимо задание следующих значений:

- `none` - значение не задано, игнорируется;
- `AAA.BBB.CCC.DDD` - приводит к созданию и/или использованию сетевого объекта типа "Хост", адрес которого используется для трансляции отправителя или получателя;
- `n/a` - значение не валидно для данного типа трансляции, игнорируется.

Для поля `Translated Service` допустимо задание следующих значений:

- `none` - значение не задано, игнорируется;
- `tcp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом TCP, номер порта которого используется для трансляции получателя;
- `udp/PPPPP` - приводит к созданию и/или использованию сервиса с протоколом UDP, номер порта которого используется для трансляции получателя;
- `n/a` - значение не валидно для данного типа трансляции, игнорируется.

Для поля `Bi-directional` допустимо задание следующих значений:

- `yes` - используется двусторонняя трансляция, создается дополнительное зеркальное правило трансляции с типом "Отобразить";
- `no` - двусторонняя трансляция не используется, создается только одно правило трансляции с типом "Отобразить";
- `n/a` - значение не валидно для данного типа трансляции, игнорируется.

Для следующих полей интерпретация их значений определяется спецификой конфигурации решения-источника (в частности - Palo Alto Networks):

- `Translation Type`;
- `Translated Interface`;
- `Translated Address`;
- `Translated Service`;
- `Bi-directional`.

Описание соответствия возможных комбинаций данных полей для Palo Alto Networks и допустимых значений полей Континент 4 прилагается отдельно.

К инструменту прилагаются следующие материалы:

- `template_input` - пример файла с исходными данными (шаблон);
- `pa_nat_mapping` - соответствия возможных комбинаций данных полей для Palo Alto Networks и допустимых значений полей Континент 4.
