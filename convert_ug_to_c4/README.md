# Назначение инструмента

Конвертация конфигурации UserGate из формата `*.json` в универсальный формат `*.json` для последующего импорта в Континент 4 (далее - К4) в объеме:

  - правила фильтрации сетевого трафика;
  - правила трансляции сетевых адресов;
  - сетевые объекты, используемые в правилах;
  - сервисы, используемые в правилах;
  - временные интервалы, используемые в правилах.

Для получения конфигурации UserGate в формате `*.json` необходимо использовать инструмент `ug_convert_config`, опубликованный по [ссылке](https://github.com/usergate/Migrations/tree/main/ug_convert_config).

При большом количестве правил и связанных в объектов в исходной конфигурации подразумевается создание нескольких файлов в универсальном формате `*.json` c нумерацией в имени, исходя:

  - либо из заданного пользователем ограничение на количество обрабатываемых объектов;
  - либо из максимально допустимого количества объектов (20000), которое может быть обработано при импорте на ЦУС.

С учетом ограничения на количество обрабатываемых объектов в результате конвертации может быть создано несколько файлов в универсальном формате `*.json`, а именно:

  - несколько файлов с суффиксом `-fw`, содержащих правила фильтрации сетевого трафика и связанные с ними объекты;
  - несколько файлов с суффиксом `-nat`, содержащих правила трансляции сетевых адресов и связанные с ними объекты.

# Замечания для правил фильтрации

1. Все импортированные правила на стороне К4 будут отключены.
2. Если на стороне UserGate не указан номер порта, на стороне К4 для "Сервиса" будет установлено значение "Любой" / "Any".
3. При импорте правил из UserGate в К4 будут добавлены следующие необходимые для корректной работы системы параметры (для этих параметров на стороне К4 будут установлены значения по умолчанию):

    - Профиль Web/FTP фильтрации;
    - Приложение;
    - СОВ.

4. При импорте правил из UserGate в К4 параметр "Действие" / "Action" переносится согласно следующим правилам:

    - если на стороне UserGate указано значение `accept`, на стороне К4 будет установлено значение "Пропустить" / "Accept";
    - в остальных случаях на стороне К4 для "Действия" будет установлено значение "Отбросить" / "Block".

# Замечания для правил трансляции

1. Все импортированные правила на стороне К4 будут отключены.
2. Не осуществляется перенос правил, для которых на стороне UserGate поля сервиса или транслированного сервиса содержат протокол, который отличается от `6` (TCP) или `17` (UDP).
3. Не осуществляется перенос правил DNAT, для которых в назначении исходного пакета установлена группа сетевых объектов.
4. Не осуществляется перенос правил DNAT, для которых в назначении исходного пакета установлен диапазон.
5. Не осуществляется перенос правил "Network mapping", для которых не установлены адреса или подсети источника исходного и транслированного пакета.
6. Не осуществляется перенос правил "Network mapping", в которых используются группы сетевых объектов или диапазоны.
7. Не осуществляется перенос правил, в которых используются группы сервисов.
8. Опция "включить SNAT" не поддерживатся и игнорируется.

# Приложения

К инструменту прилагаются следующие материалы:

- `c4_unified_json.svg` - описание структуры (схема) импортируемых данных.
