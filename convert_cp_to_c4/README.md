# Подготовка к работе

1. Скачайте и установите последнюю версию интерпретатора Python.
2. Выполните распаковку скрипта `convert_cp_to_c4.py`, разместив содержимое в любой каталог на рабочем месте (РМ) администратора.

>**Внимание:** Запуск скрипта `convert_cp_to_c4.py` может выполняться как на рабочем месте администратора с установленным менеджером конфигурации (МК), так и на стороннем рабочем месте. Если скрипт `convert_cp_to_c4.py` и МК находятся на разных РМ подразумевается, что сгенерированные файлы для импорта в МК необходимо будет перенести на РМ с установленным МК.

# Алгоритм работы

1. Запустите командную строку.
2. В командной строке перейдите в каталог, где распакован скрипт `convert_cp_to_c4.py`.
3. Запустите скрипт с помощью команды `python convert_cp_to_c4.py`.
4. На экран будет выведено руководство по использованию скрипта. Ознакомьтесь с руководством!
5. Следуя инструкции укажите путь до файла c правилами для преобразования в формате `*.fws` (**INPUT_RULES**).
6. Следуя инструкции укажите путь до файла c объектами, содержащимися в правилах `*.с` (**INPUT_OBJECTS**).
7. Следуя инструкции укажите путь до папки для сохранения преобразованного файла (**OUTPUT_PATH**).
8. Следуя инструкции укажите имя одиной из политик, содержащихся в файле с правилами, для преобразования (**POLICY_NAME**).
9. При необходимости Вы можете скорректировать стандартное имя для файла с отчетом (**LOG**).
10. При необходимости Вы можете скорректировать стандартное имя для преобразованного файла (**NAME**).
11. Убедитесь, что по окончанию работы скрипта сгенерирован отчет в командной строке.
12. Убедитесь, что по окончанию работы скрипта в папке для сохранения преобразованного файла лежит два файла:
    - файл, содержащий конфигурацию в универсальном формате `*.json`; 
    - отчет о результате операции импорта.

# Импорт правил фильтрации

## Алгоритм импорта правил фильтрации (`fw_rule`) из различных систем в Континент через МК

1. Запустите МК.
2. Выполните подключение к ЦУС.
3. Перейдите в раздел "Контроль доступа" / "Межсетевой экран".
4. В пустой области секции "Межсетевой экран" используйте пункт "Импортировать" контекстного меню.
5. Будет выведено диалоговое окно для выбора файла конфигурации из внешней системы.
6. Выберите файл конфигурации в универсальном формате `*.json`, сгенерированных ранее скриптом `convert_CP_to_C4.py`.
7. Нажмите кнопку "Открыть".
8. Дождитесь окончания импорта.
9. После завершения операции импорта будет выведено информационное сообщение о результате выполнения импорта.
10. Ознакомьтесь с результатами выполнения импорта.

## Просмотр детальной информации о результатах импорта

1. Перейдите в раздел "Администрирование" / "Задачи".
2. Выберите в списке задачу "Импорт политики контроля доступа", соответствующую времени запуска и окончания импорта.
3. В окне "Информация" будет представлен отчет, содержащем сообщения о результатах операции импорта. Если окно не отображается, перейдите на вкладку "Вид" и активируйте кнопку "Информация". 

## Ограничения для правил фильтрации

1. Все импортированные правила на стороне Континент 4 (далее – К4) будут отключены, вне зависимости от оригинального значения параметра "Disabled" в Check Point.
2. В описании каждого правила будут отражены следующие параметры:
    - описание объекта системы из Check Point;
    - значения параметров, которые не переносятся из Check Point в К4 или каким либо-образом трансформируются;
    - информация о наличии связей между объектами системы и сетевыми устройствами.
3. Если в качестве "Source" на стороне Check Point не указано ни одного сетевого объекта на стороне К4 для "Отправителя" будет установлено значение "Любой" / "Any".
4. Если в качестве "Destination" на стороне Check Point не указано ни одного сетевого объекта на стороне К4 для "Получателя" будет установлено значение "Любой" / "Any".
5. При импорте правил из Check Point в К4 не осуществляется перенос сетевых объектов, тип которых отличается от `host` / `network` / `machines_range` / `group`.
6. Если в качестве "Service" на стороне Check Point не указано ни одного объекта на стороне К4 для "Сервиса" будет установлено значение "Любой" / "Any".
7. При импорте правил из Check Point в К4 не осуществляется перенос сервисов с типом `DceRpc` или `icmpv6`.
8. При импорте правил из Check Point в К4 не осуществляется перенос других сервисов с протоколами `0` / `41` / `43` / `44` / `45` / `46` / `50` / `51` / `58` / `59` / `60`.
9. При импорте правил из Check Point в К4 параметр "Действие" / "Action" переносится согласно следующим правилам:
    - если в качестве "Action" на стороне Check Point указано значение "Accept" на стороне К4 для «Действия» будет установлено значение "Пропустить" / "Accept";
    - если в качестве "Action" на стороне Check Point указано значение "Reject" на стороне К4 для «Действия» будет установлено значение "Отбросить" / "Drop";
    - если в качестве "Action" на стороне Check Point указано значение "Drop" на стороне К4 для «Действия» будет установлено значение "Отбросить" / "Drop".
10. При импорте правил из Check Point в К4 не осуществляется перенос правил фильтрации, действие которых отличается от `accept` / `reject` / `drop`.
11. Если в качестве "Time" на стороне Check Point не указано ни одного объекта на стороне К4 для «Временного интервала» будет установлено значение "Всегда" / "Always".
12. При импорте правил из Check Point в К4 не осуществляется перенос временных объектов с типом `scheduled_event` или `group`. 
13. При импорте правил из Check Point в К4 не осуществляется перенос временных объектов, содержащих значение месяца и порядкового дня месяца в качестве старта или окончания временного интервала.
14. При импорте правил из Check Point в К4 не осуществляется перенос временных объектов, содержащих значение месяца и порядкового дня месяца в качестве периода повторения работы временного интервала.
15. При импорте правил из Check Point в К4 параметр "Track" / "Лог" ("Log") переносится согласно следующим правилам:
    - если в качестве "Track" на стороне Check Point указано значение "Alert" на стороне К4 будет автоматически включено логирование работы правила;
    - если в качестве "Track" на стороне Check Point указано значение "Log" на стороне К4 будет автоматически включено логирование работы правила;
    - если в качестве "Track" на стороне Check Point указано значение "None" на стороне К4 не будет автоматически включено логирование работы правила (логирование выключено).
16. При импорте правил из Check Point в К4 не осуществляется перенос правил фильтрации, для которых параметр "Track" равен "Account".
17. В К4 не переносится параметр "VPN".
18. При импорте правил из Check Point в К4 будут добавлены следующие необходимые для корректной работы системы параметры (для этих параметров на стороне К4 будут установлены значения по умолчанию): 
    - Профиль Web/FTP фильтрации;
    - Приложение;
    - СОВ. 
19. Для сетевых объектов типа `host` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - NAT;
    - SNMP;
    - Color;
    - FIreWall-1 GX;
    - IPv6 adress;
    - OS.
20. Для сетевых объектов типа `network` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - NAT;
    - Broadcast;
    - Color;
    - Network address (IPv6);
    - Prefix (IPv6).
21. Для сетевых объектов типа `machines_range` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - NAT;
    - Color;
    - First IPv6 address;
    - Last IPv6 address.
22. Для сервисов типа `tcp` / `udp` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - Color;
    - Enable Aggressive Aging;
    - Aggressive Aging Timeout;
    - Protocol type;
    - Accept Peplies;
    - Match for "Any";
    - Synchronize connections on Cluster;
    - Start synchronizing;
    - Enable for TCP resource.
23. Для сервисов типа `other` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - Color;
    - Enable Aggressive Aging;
    - Aggressive Aging Timeout;
    - Protocol type;
    - Accept Peplies;
    - Synchronize connections on Cluster.
24. Для сервисов типа `icmp` при импорте правил из Check Point в К4 не осуществляется перенос следующих параметров: 
    - Color;
    - Protocol type.
