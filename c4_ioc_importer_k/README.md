# Используемые обозначения

ЦУС - Центр управления сетью.

УБ - Узел безопасности.

СД - Сервер доступа.

МК - Менеджер конфигурации.

АРМ - Автоматизированное рабочее место.

# Назначение инструмента

Импорт через API Континент 4 объектов IoC (Indicator of Compromise) от вендора [Kaspersky](https://www.kaspersky.ru/enterprise-security/symphony-xdr?ysclid=lwkmdar83g581733449), включая IP адреса, URL, хэши файлов и домены (FQDN), из контейнера `*.json` в следующем формате:

```
[
    {
        "type": "ip",
        "value": "172.16.10.100"
    },
    {
        "type": "domain",
        "value": "sample.com"
    },
    {
        "type": "url",
        "value": "https://sample.com/resource"
    },
    {
        "type": "hash",
        "md5": "47e2f91bcd4ce5af00b0f1b7b3ab54dc",
        "filename": "sample.txt",
        "filesize": 38
    }
]
```

# Основные функции

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Импорт IP адресов в качестве объектов ЦУС типа "Хост" в формате `IoC_K_AAA.BBB.CCC.DDD`. Объекты также помещаются в группу `IoC_K_IP_Group`.
3. Импорт URL в качестве Web/FTP фильтров в составе группы в формате `IoC_K_URL_HTTP_Group` (для URL со схемой HTTP) и `IoC_K_URL_HTTPS_Group` (для URL со схемой HTTPS).
4. Импорт доменов (FQDN) в качетсве объектов ЦУС типа "DNS имя" в формате `IoC_K_sample.com`. Объекты также помещаются в группу `IoC_K_Domain_Group`.
5. Импорт хэшей файлов в качестве пользовательской базы для встроенного в Континент 4 потокового антивируса через репозиторий обновлений ЦУС.
6. Опциональное создание блокирующих правил фильтрации с использованием импортированных IP адресов в формате `IoC: Malicious Hosts Block`.
7. Опциональное создание блокирующих правил фильтрации с использованием импортированных доменов (FQDN) в формате `Malicious FQDN Block`.
8. Опциональное создание блокирующих правил фильтрации с использованием импортированных URL и хэшей файлов в формате `IoC: Malicious URL & Hashes Block`. 
6. Вывод на экран справки по использованию инструмента.

# Основные характеристики

1. Инструмент представлен набором скриптов на языке Python.
2. Инструмент предоставляет пользователю интерфейс CLI.
3. Инструмент поставляется в виде архива `tar.gz`.
4. Инструмент содержит встроенную справку по использованию (ключи, параметры).
5. Инструмент доустанавливает необходимые для работы компоненты.
6. Расписание доставки на УБ списка импортированных хэшей файлов администратор настраивает самостоятельно.

# Системные требования

1. АРМ пользователя под управлением ОС Linux.
2. Физический и логический сетевой доступ АРМ пользователя к ЦУС.
3. Установленный на АРМ пользователя интерпретатор Python последней версии.
4. Установленный на АРМ пользователя компонент `openssl` версии 3.0.
5. Наличие IP адреса АРМ пользователя в списке разрешенных для подключения к ЦУС.
6. Учетная запись Континент 4 с ролью **Главный администратор**.

# Инструкция по установке

1. Выполнить установку библиотеки `c4_lib`, если ранее это не было сделано.
2. Скачать архив `c4_ioc_importer_k-X.X.tar.gz`.
3. Распаковать скаченный архив в любую директорию.
4. Перейти в директорию, куда был распакован архив, затем - в директорию `c4_ioc_importer_k`, убедиться в наличии файла `setup.py`.
5. Выполнить команду `pip install . -f . --no-index` для установки компонентов, необходимых для работы инструмента.
6. Дождаться завершения установки компонентов, необходимых для работы инструмента.
7. В случае отсутствия пути до установленного инструмента в переменной окружения `PATH` пропишите его вручную (особенность дистрибутива ОС Linux).
8. Вызвать встроенную справку и ознакомиться с ее содержанием.
9. Инструмент готов к использованию.
