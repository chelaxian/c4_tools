# Назначение инструмента

Импорт через API Континент 4 объектов IoC (Indicator of Compromise) от вендора [Kaspersky](https://www.kaspersky.ru/enterprise-security/symphony-xdr?ysclid=lwkmdar83g581733449), включая IP адреса, URL, хэши файлов и домены (FQDN), из контейнера `*.json` в следующем формате:

```
[
    {
        "type": "ip",
        "value": "172.16.10.100"
    },
    {
        "type": "domain",
        "value": "sample.com"
    },
    {
        "type": "url",
        "value": "https://sample.com/resource"
    },
    {
        "type": "hash",
        "md5": "47e2f91bcd4ce5af00b0f1b7b3ab54dc",
        "filename": "sample.txt",
        "filesize": 38
    }
]
```

# Основные функции

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Импорт IP адресов в качестве объектов ЦУС типа "Хост" в формате `IoC_K_AAA.BBB.CCC.DDD`. Объекты также помещаются в группу `IoC_K_IP_Group`.
3. Импорт URL в качестве Web/FTP фильтров в составе группы в формате `IoC_K_URL_HTTP_Group` (для URL со схемой HTTP) и `IoC_K_URL_HTTPS_Group` (для URL со схемой HTTPS).
4. Импорт доменов (FQDN) в качетсве объектов ЦУС типа "DNS имя" в формате `IoC_K_sample.com`. Объекты также помещаются в группу `IoC_K_Domain_Group`.
5. Импорт хэшей файлов в качестве пользовательской базы для встроенного в Континент 4 потокового антивируса через репозиторий обновлений ЦУС.
6. Опциональное создание блокирующих правил фильтрации с использованием импортированных IP адресов в формате `IoC: Malicious Hosts Block`.
7. Опциональное создание блокирующих правил фильтрации с использованием импортированных доменов (FQDN) в формате `Malicious FQDN Block`.
8. Опциональное создание блокирующих правил фильтрации с использованием импортированных URL и хэшей файлов в формате `IoC: Malicious URL & Hashes Block`. 
6. Вывод на экран справки по использованию инструмента.

> Расписание доставки на УБ списка импортированных хэшей файлов администратор настраивает самостоятельно.
