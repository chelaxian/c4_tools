# Назначение инструмента

Импорт через API Континент 4 объектов IoC (Indicator of Compromise) от вендора [Kaspersky](https://www.kaspersky.ru/enterprise-security/symphony-xdr?ysclid=lwkmdar83g581733449), включая IP адреса, URL, хэши файлов и домены (FQDN), из контейнера `*.json` в следующем формате:

```
[
    {
        "type": "ip",
        "value": "172.16.10.100"
    },
    {
        "type": "domain",
        "value": "sample.com"
    },
    {
        "type": "url",
        "value": "https://sample.com/resource"
    },
    {
        "type": "hash",
        "md5": "47e2f91bcd4ce5af00b0f1b7b3ab54dc",
        "filename": "sample.txt",
        "filesize": 38
    }
]
```

# Основные функции

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Импорт IP адресов в качестве объектов ЦУС типа "Хост" и помещение их в соответствующую группу.
3. Импорт URL в качестве Web/FTP фильтров и помещение их в соответствующие группы.
4. Импорт доменов (FQDN) в качетсве объектов ЦУС типа "DNS имя" и помещение их в соответствующую группу.
5. Импорт хэшей файлов в качестве пользовательской базы для потокового антивируса через репозиторий обновлений ЦУС.
6. Опциональное создание блокирующих правил фильтрации.
7. Вывод на экран справки по использованию инструмента.
8. Соблюдение следующего порядка именования созданных при импорте объектов:

```
    --- IPs ---
    IoC_K_AAA.BBB.CCC.DDD                       // Вредоносный хост
    IoC_K_IP_Group                              // Группа вредоносных хостов
    --- Domains ---
    IoC_K_sample.com                            // Вредоносный домен
    IoC_K_Domain_Group                          // Группа вредоносных доменов
    --- URLs ---
    IoC_K_URL_HTTP_Group                        // Группа URL-ов со схемой HTTP
    IoC_K_URL_HTTPS_Group                       // Группа URL-ов со схемой HTTPS
    --- ECAPs ---
    IoC_K_ECAP                                  // ECAP сервис (потоковый антивирус)
    --- Profiles ---
    IoC_K_HTTPS_Profile                         // Профиль Web/FTP со схемой HTTPS
        > IoC_K_URL_HTTP_Group                  // См. выше
        > IoC_K_URL_HTTPS_Group                 // См. выше
        > IoC_K_ECAP                            // См. выше
    --- FW Rules ---
    IoC: Malicious Hosts Block - Source         // Правило для блокировки вредоносных хостов (отправителей)
    IoC: Malicious Hosts Block - Destination    // Правило для блокировки вредоносных хостов (получателей)
    IoC: Malicious FQDN Block - Source          // Правило для блокировки вредоносных доменов (отправителей)
    IoC: Malicious FQDN BLock - Destination     // Правило для блокировки вредоносных доменов (получателей)
    IoC: Malicious URL & Hashes Block           // Правило для блокировки вредоносных URL и хэшей
```

> Расписание доставки на УБ списка импортированных хэшей файлов администратор настраивает самостоятельно.
