# Используемые обозначения

ЦУС - Центр управления сетью.

УБ - Узел безопасности.

МК - Менеджер конфигурации.

АРМ - Автоматизированное рабочее место.

# Назначение инструмента

Импорт через API Континент 4 объектов IoC (Indicator of Compromise) от вендора [R-Vision](https://rvision.ru/), включая IP адреса, URL и домены (FQDN), из контейнера `*.json` в следующем формате:

```
[
    {
        "type": "ip",
        "value": "10.10.10.10",
        "created_at": null,
        "modified_at": null,
        "collected_at": "YYYY-MM-DDTHH:MM:SS.MSS+TZ"
    },
    {
        "type": "domain",
        "value": "sample.com",
        "created_at": null,
        "modified_at": null,
        "collected_at": "YYYY-MM-DDTHH:MM:SS.MSS+TZ"
    },
    {
        "type": "url",
        "value": "https://sample.com/malicious/resource",
        "created_at": null,
        "modified_at": null,
        "collected_at": "YYYY-MM-DDTHH:MM:SS.MSS+TZ"
    }
]
```

# Основные функции

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Импорт IP адресов в качестве объектов ЦУС типа "Хост" в формате `IoC_AAA.BBB.CCC.DDD`. Объекты также помещаются в группу `IoC_IP`.
3. Импорт URL в качестве Web/FTP фильтров в составе группы в формате `IoC_URL_http` (для URL со схемой HTTP) и `IoC_URL_https` (для URL со схемой HTTPS).
4. Импорт доменов (FQDN) в качетсве объектов ЦУС типа "DNS имя" в формате `IoC_dom1.dom2.dom3`. Объекты также помещаются в группу `IoC_domains`.
5. Вывод на экран справки по использованию инструмента.

# Основные характеристики

1. Инструмент представлен набором скриптов на языке Python.
2. Инструмент предоставляет пользователю интерфейс CLI.
3. Инструмент поставляется в виде архива `tar.gz`.
4. Инструмент содержит встроенную справку по использованию (ключи, параметры).
5. Инструмент доустанавливает необходимые для работы компоненты.

# Системные требования

1. АРМ пользователя под управлением ОС Linux.
2. Физический и логический сетевой доступ АРМ пользователя к ЦУС.
3. Установленные на АРМ пользователя интерпретатор Python последней версии.
4. Установленный на АРМ пользователя компонент `openssl` версии 3.0.
5. Наличие IP адреса АРМ пользователя в списке разрешенных для подключения к ЦУС.
6. Учетная запись Континент 4 с ролью **Главный администратор**.

# Инструкция по установке

1. Выполнить установку библиотеки `c4_lib`, если ранее это не было сделано.
2. Скачать архив `c4_ioc_importer_rv-X.X.tar.gz`.
3. Распаковать скаченный архив в любую директорию.
4. Перейти в директорию, куда был распакован архив, затем - в директорию `c4_ioc_importer_rv`, убедиться в наличии файла `setup.py`.
5. Выполнить команду `pip install . -f . --no-index` для установки компонентов, необходимых для работы инструмента.
6. Дождаться завершения установки компонентов, необходимых для работы инструмента.
7. В случае отсутствия пути до установленного инструмента в переменной окружения `PATH` пропишите его вручную (особенность дистрибутива ОС Linux).
8. Вызвать встроенную справку и ознакомиться с ее содержанием.
9. Инструмент готов к использованию.
