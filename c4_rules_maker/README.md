# Используемые обозначения

ЦУС - Центр управления сетью.

УБ - Узел безопасности.

МК - Менеджер конфигурации.

АРМ - Автоматизированное рабочее место.

# Назначение инструмента

Генерация через API Континент 4 заданного количества правил по схеме:

```
Правило фильтрации
    Порядковый номер:                Автоматически по порядку
    Название:                        FW_Rule_{Num}                   // {Num} = 1..32767
    Отправитель:                     Host_{Set}_{Num}_1              // {Set} = 1..250, {Num} = 1..65534
    Получатель:                      Host_{Set}_{Num}_2              // {Set} = 1..250, {Num} = 1..65534
    Сервис:                          Service_{Proto}                 // {Proto} = TCP/UDP/ICMP
    Протокол/Приложение:             Любой
    Действие:                        {Action}                        // {Action} = Пропустить / Блокировать
    Профиль:                         Нет
    СОВ:                             Выкл
    Интервал:                        Всегда
    Лог:                             {Log}                           // {Log} = Лог / Нет
    Установить:                      Везде
    Описание:                        Пусто

Правило трансляции
    Порядковый номер:                Автоматически по порядку
    Название:                        NAT_Rule_{Num}                  // {Num} = 1..32767 (для каждого типа трансляции)
    Оригинальный отправитель:        Host_{Set}_{Num}_1              // {Set} = 1..250, {Num} = 1..65534
    Оригинальный получатель:         Host_{Set}_{Num}_2              // {Set} = 1..250, {Num} = 1..65534
    Оригинальный сервис:             Service_{Proto}                 // {Proto} = TCP/UDP
    Трансляция:                      {Action}                        // {Action} = Не транслировать / Скрыть / Отправителя / Получателя / Отобразить
    Транслированный отправитель:     Trans_Host
    Транслированный получатель:      Trans_Host
    Транслированный сервис:          Trans_Service_{Proto}_{Port}    // {Proto} = TCP/UDP, {Port} = SrcPort / DstPort
    Интерфейс                        Автоматически
    Установить                       Везде
    Описание                         Пусто

Хост (оригинальный)
    Название:                        Host_{Set}_{Num}_N              // N = 1 / 2
    Адрес:                           AAA.BBB.CCC.DDD                 // 10.10.0.0/16, кроме 255
    Описание:                        Пусто

Хост (транслированный)
    Название:                        Trans_Host
    Адрес:                           172.16.10.10
    Описание:                        Пусто

Сервис (оригинальный)
    Название:                        Service_{Proto}
    Протокол:                        TCP / UDP / ICMP                // ICMP - только для правил фильтрации
    Порт отправителя:                Любой
    Порт получателя:                 Любой
    Тип сообщения:                   Любой
    Код сообщения:                   Любой
    Описание:                        Пусто

Сервис (транслированный)
    Название:                        Trans_Service_{Proto}_{Port}
    Протокол:                        TCP / UDP                       // Соответствует протоколу оригинального сервиса
    Порт отправителя:                Любой / 12345                   // 12345 - только для трансляции отправителя
    Порт получателя:                 Любой / 12345                   // 1234 - только для трансляции получателя
    Описание:                        Пусто
```

# Основные функции инструмента

1. Использование библиотеки `c4_lib` для работы с API Континент 4.
2. Генерация N правил фильтрации с M уникальными парами сетевых объектов типа "Хост".
3. Вывод на экран справки по использованию инструмента.

# Основные характеристики инструмента

1. Инструмент представлен набором скриптов на языке Python.
2. Инструмент предоставляет пользователю интерфейс CLI.
3. Инструмент поставляется в виде архива `tar.gz`.
4. Инструмент содержит встроенную справку по использованию (ключи, параметры).
5. Инструмент доустанавливает необходимые для работы компоненты по зависимостям.
6. Инструмент можно использовать для наполнения БД конфигурации ЦУС шаблонными правилами и объектами и последующего нагрузочного тестирования ЦУС в части установки политики.

# Системные требования к инструменту

1. АРМ пользователя под управлением ОС Linux.
2. Физический и логический сетевой доступ АРМ пользователя к ЦУС.
3. Установленные на АРМ пользователя интерпретатор Python последней версии.
4. Установленный на АРМ пользователя компонент `openssl` версии 3.0.
5. Наличие IP адреса АРМ пользователя в списке разрешенных для подключения к ЦУС.
6. Учетная запись Континент 4 с ролью **Главный администратор**.
7. Отсутствие дубликатов правил и объектов после предыдущего цикла работы инструмента.

# Инструкция по установке

1. Выполнить установку библиотеки `c4_lib`, если ранее это не было сделано.
2. Скачать архив `c4_rules_maker-X.X.tar.gz`.
3. Распаковать скаченный архив в любую директорию.
4. Перейти в директорию, куда был распакован архив, затем - в директорию `c4_rules_maker`, убедиться в наличии файла `setup.py`.
5. Выполнить команду `pip install . -f . --no-index` для установки компонентов, необходимых для работы инструмента.
6. Дождаться завершения установки компонентов, необходимых для работы инструмента.
7. В случае отсутствия пути до установленного инструмента в переменной окружения `PATH` пропишите его вручную (особенность дистрибутива ОС Linux).
8. Вызвать встроенную справку и ознакомиться с ее содержанием.
9. Убедиться в наличии файла настроек для работы инструмента - `settings.json`.
10. Инструмент готов к использованию.

# Приложения

В качестве входных данных инструмент использует файл `settings.json` со следующими директивами для инструмента:

- `fwrule_create` = [`true` / `false`] - признак того, что инструмент должен создать правила фильтрации;
- `fwrule_logging` = [`true` / `false`] - признак того, что в правилах фильтрации должно быть включено логирование;
- `fwrule_create` = [`true` / `false`] - признак того, что правила фильтрации должны быть блокирующими;
- `original_create` = [`true` / `false`] - признак того, что инструмент должен создать правила трансляции с типом "Не транслировать";
- `masquerade_create` = [`true` / `false`] - признак того, что инструмент должен создать правила трансляции с типом "Скрыть";
- `dynamic_create` = [`true` / `false`] - признак того, что инструмент должен создать правила трансляции с типом "Отправителя";
- `dnat_create` = [`true` / `false`] - признак того, что инструмент должен создать правила трансляции с типом "Получателя";
- `static_create` = [`true` / `false`] - признак того, что инструмент должен создать правила трансляции с типом "Отобразить";
- `tcp_service_include` = [`true` / `false`] - признак того, что при создании правил должны использоваться сервисы TCP;
- `udp_service_include` = [`true` / `false`] - признак того, что при создании правил должны использоваться сервисы UDP;
- `icmp_service_include` = [`true` / `false`] - признак того, что при создании правил должны использоваться сервисы ICMP (только для правил фильтрации);
- `nat_service_type` = [`none`, `tcp`, `udp`] - варианты использования сервисов в транслированных пакетах;
- `rules_start_index` = N - начальный индекс правила (используется при расчете количества создаваемых правил);
- `rules_end_index` = M - конечный индекс правила M < N (используется при расчете количества создаваемых правил);
- `host_set_num` = K - количество наборов хостов в одной ячейке правила.
